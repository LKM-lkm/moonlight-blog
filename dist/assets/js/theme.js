class ThemeManager{constructor(){this.themeKey="moonlight_theme",this.defaultTheme="light",this.themes=["light","dark","auto"],this.init()}init(){const e=localStorage.getItem(this.themeKey)||"auto";this.applyTheme(e),this.watchSystemTheme(),this.bindThemeToggle()}getSystemTheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}watchSystemTheme(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{"auto"===localStorage.getItem(this.themeKey)&&this.applyTheme("auto")}))}bindThemeToggle(){document.querySelectorAll(".theme-toggle, #theme-toggle-btn").forEach((e=>{e.addEventListener("click",(()=>{const e=localStorage.getItem(this.themeKey)||"auto";let t;t="auto"===e?"dark":"dark"===e?"light":"auto",this.applyTheme(t),localStorage.setItem(this.themeKey,t)}))}))}applyTheme(e){const t="auto"===e?this.getSystemTheme():e;document.documentElement.setAttribute("data-theme",t);document.querySelectorAll(".theme-toggle, #theme-toggle-btn").forEach((t=>{const a=t.querySelector("i")||t;"auto"===e?(a.className="fas fa-adjust",t.title="跟随系统"):"dark"===e?(a.className="fas fa-sun",t.title="切换到亮色模式"):(a.className="fas fa-moon",t.title="切换到暗色模式")})),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:t,preference:e}}))}}document.addEventListener("DOMContentLoaded",(()=>{window.themeManager=new ThemeManager}));