# 用户管理系统文档

## 目录
1. [系统概述](#系统概述)
2. [功能特性](#功能特性)
3. [技术架构](#技术架构)
4. [安装配置](#安装配置)
5. [使用指南](#使用指南)
6. [API接口](#API接口)
7. [错误处理](#错误处理)
8. [安全说明](#安全说明)
9. [常见问题](#常见问题)

## 系统概述

用户管理系统是一个完整的用户管理解决方案，提供了用户注册、登录、权限管理等功能。系统采用前后端分离架构，后端使用PHP开发，前端使用HTML、CSS和JavaScript实现。

### 主要功能
- 用户注册和登录
- 用户信息管理
- 角色和权限管理
- 用户状态管理
- 登录日志记录
- 安全防护机制

## 功能特性

### 用户管理
- 创建新用户
- 编辑用户信息
- 删除用户
- 重置用户密码
- 管理用户状态（启用/禁用）

### 角色管理
- 预设角色：管理员、编辑、普通用户
- 自定义角色权限
- 角色分配和回收

### 权限管理
- 细粒度的权限控制
- 权限组管理
- 权限继承机制

### 安全特性
- 密码加密存储
- 登录尝试限制
- 会话管理
- XSS防护
- CSRF防护
- SQL注入防护

## 技术架构

### 后端技术
- PHP 7.4+
- MySQL 5.7+
- PDO数据库连接
- 面向对象编程

### 前端技术
- HTML5
- CSS3
- JavaScript (ES6+)
- 响应式设计

### 目录结构
```
admin/
├── api/            # API接口
├── assets/         # 静态资源
│   ├── css/       # 样式文件
│   └── js/        # JavaScript文件
├── config/         # 配置文件
├── docs/          # 文档
├── includes/      # 核心类文件
├── sql/           # SQL脚本
├── tests/         # 测试文件
└── views/         # 视图文件
```

## 安装配置

### 系统要求
- PHP 7.4或更高版本
- MySQL 5.7或更高版本
- Apache/Nginx Web服务器
- mod_rewrite模块（Apache）

### 安装步骤
1. 克隆代码库到本地
2. 导入数据库结构（`sql/users.sql`）
3. 配置数据库连接（`config/database.php`）
4. 设置文件权限
5. 配置Web服务器

### 配置文件
主要配置文件位于`config`目录：
- `database.php`: 数据库配置
- `security.php`: 安全相关配置
- `logger.php`: 日志配置

## 使用指南

### 用户管理
1. 登录系统
2. 进入用户管理页面
3. 使用搜索和过滤功能查找用户
4. 执行用户管理操作

### 创建用户
1. 点击"创建用户"按钮
2. 填写用户信息
3. 选择用户角色
4. 设置初始密码
5. 提交表单

### 编辑用户
1. 在用户列表中找到目标用户
2. 点击"编辑"按钮
3. 修改用户信息
4. 保存更改

### 删除用户
1. 在用户列表中找到目标用户
2. 点击"删除"按钮
3. 确认删除操作

## API接口

### 用户列表
```
GET /api/users.php
参数：
- page: 页码
- limit: 每页数量
- search: 搜索关键词
- role: 角色过滤
- status: 状态过滤
```

### 获取用户
```
GET /api/users.php?id={userId}
```

### 创建用户
```
POST /api/users.php
数据：
{
    "username": "用户名",
    "email": "邮箱",
    "password": "密码",
    "role": "角色",
    "status": "状态"
}
```

### 更新用户
```
PUT /api/users.php?id={userId}
数据：
{
    "username": "新用户名",
    "email": "新邮箱",
    "role": "新角色",
    "status": "新状态"
}
```

### 删除用户
```
DELETE /api/users.php?id={userId}
```

## 错误处理

### 错误代码
- 400: 请求参数错误
- 401: 未授权
- 403: 权限不足
- 404: 资源不存在
- 500: 服务器错误

### 错误响应格式
```json
{
    "error": {
        "code": 错误代码,
        "message": "错误信息",
        "details": "详细说明"
    }
}
```

## 安全说明

### 密码安全
- 使用bcrypt加密存储密码
- 密码最小长度要求
- 密码复杂度要求
- 定期密码更新提醒

### 会话安全
- 会话超时设置
- 会话ID加密
- 防止会话固定攻击

### 数据安全
- 输入数据验证
- 输出数据转义
- 敏感数据加密

## 常见问题

### 1. 如何重置用户密码？
答：在用户管理页面找到目标用户，点击"重置密码"按钮，系统会生成随机密码并发送到用户邮箱。

### 2. 如何处理用户登录失败？
答：系统会自动记录登录失败次数，超过限制后会临时锁定账号。管理员可以在后台查看登录日志并处理异常情况。

### 3. 如何添加新的用户角色？
答：在角色管理页面点击"添加角色"按钮，设置角色名称和权限，然后保存即可。

### 4. 如何导出用户数据？
答：在用户列表页面使用导出功能，支持导出为CSV或Excel格式。

### 5. 如何处理用户权限冲突？
答：系统采用权限优先级机制，高优先级权限会覆盖低优先级权限。管理员可以在角色设置中调整权限优先级。 